{"version":3,"sources":["simple_revision.js"],"names":["app","SimpleRevisionView","Backbone","View","extend","el","events","click #instruction-read","click #help","click #editor-button","click #save-text","initialize","self","this","prePageDurationStart","postPageDurationStart","userModel","UserSpecificModel","textModel","TextModelComplete","analyzer","TextAnalyzerModel","fetch","success","model","response","renderInstruction","error","console","log","$el","html","Handlebars","templates","instruction","get","renderEditor","Date","editor","MediumEditor","toolbar","placeholder","$","editableElement","document","querySelector","firstChild","selectElement","append","renderInstructionModal","openModal","analyzeText","regExText","text","getParagraphs","find","length","Materialize","toast","draftElapsed","set","pre_page_duration","pre_text","save","renderRevision","responseText","pre_num_sentences","pre_num_clusters","pre_num_coherent_sentences","pre_num_non_coherent_sentences","pre_num_concepts","saveText","revisionElapsed","post_text","post_page_duration","sendToServer","post_num_sentences","post_num_clusters","post_num_coherent_sentences","post_num_non_coherent_sentences","post_num_concepts","location","reload"],"mappings":"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","file":"simple_revision.js","sourcesContent":["var app = app || {};\n\napp.SimpleRevisionView = Backbone.View.extend({\n    \n    el: '#treatment-simple-revision',\n\n    events: {\n        'click #instruction-read': 'renderEditor',\n        'click #help': 'renderInstructionModal',\n        'click #editor-button': 'analyzeText',\n        'click #save-text': 'saveText',\n    },\n\n    initialize: function() {\n        // Variable declaration\n        var self = this;\n        this.prePageDurationStart = null;\n        this.postPageDurationStart = null;\n        \n        // Get user data\n        this.userModel = new app.UserSpecificModel();\n\n        // Init textanalyzer model\n        this.textModel = new app.TextModelComplete();\n\n        // Init textAnalyzer model\n        this.analyzer = new app.TextAnalyzerModel();\n\n        // Fetch user data\n        this.userModel.fetch({\n            success: function(model, response) {\n                self.renderInstruction();\n            },\n            error: function(model, response) {\n                console.log(response);\n            }\n        });\n    },\n\n    /** Render instruction for \n      * this part of the experiment\n      */\n    renderInstruction: function() {\n        // Render instruction\n        this.$el.html(\n            Handlebars.templates.instruction({'instruction':\n                this.userModel.get('instruction')}));\n    },\n\n    /** \n     * When user has read the instruction he or she is able\n     * to write their text.\n     */\n    renderEditor: function() {\n        // Start timer for draft\n        this.prePageDurationStart = new Date();\n\n        // Render editor\n        this.$el.html(Handlebars.templates.editor());\n\n        // Enable editor functionality\n        var editor = new MediumEditor('#editor-textinput', {\n            toolbar: false,\n            placeholder: false,\n        });\n\n        // Add text to editor\n        $('#editor-textinput').html('<p>Schreibe hier ...</p>');\n\n        // Select text so that user can type instantly\n        var editableElement = document.\n            querySelector('#editor-textinput').firstChild;\n        editor.selectElement(editableElement);\n\n        // Append help button to window\n        this.$el.append('<i id=\"help\" class=\"material-icons\">help</i>');\n\n        // Append modal \n        this.$el.append(Handlebars.templates['modal-help']({'instruction':\n            this.userModel.get('instruction') }));\n    },\n\n    /**\n     * Render modal of instruction\n     */\n    renderInstructionModal: function() {\n        $('#modal-help').openModal();\n    },\n\n    /**\n     * After user has written his or her text the \n     * user gets feedback on the draft. \n     * Before users can see the feedback we need \n     * to make some sanity checks whether the \n     * text is long enough.\n     */\n    analyzeText: function() {\n        var self = this;\n\n        // Change text with major concepts\n        app.regExText('#editor-textinput');\n\n        // Get text\n        var text = app.getParagraphs(this.$el.find('#editor-textinput'));\n\n        // Check if text is long enough\n        if (text.length < 1000) {\n            // Display toast\n            Materialize.toast('Ihr Text ist leider zu kurz.', 4000);\n        } else {\n            // Stop timer for draft\n            var draftElapsed = (new Date() - this.prePageDurationStart) / 1000;\n\n            // Start timer for text revision\n            this.postPageDurationStart = new Date();\n\n            // Set draft time and draftText to textModel\n            this.textModel.set({'pre_page_duration': draftElapsed,\n                                'pre_text': text});\n\n            // Render loading ring\n            this.$el.find('#editor-button-div').html(\n                Handlebars.templates['loading-ring']());\n\n            // Get text data\n            this.analyzer.set({'text': text});\n            this.analyzer.save(null, {\n                success: function(response) {\n                    self.renderRevision();\n                },\n                error: function(model, response) {\n                    console.log(response.responseText);\n                }\n            });\n        }\n    },\n\n    /**\n     * After user has written the draft she gets the \n     * opportunity to revise her text\n     */\n    renderRevision: function() {\n        // Render submit button\n        this.$el.find('#editor-button-div').html(\n                '<a class=\"waves-effect waves-light btn\" id=\"save-text\">Text abschicken</a>');\n\n        // Save data for draft\n        this.textModel.set({'pre_text': this.analyzer.get('text'),\n            'pre_num_sentences': this.analyzer.get('numSentences'),\n            'pre_num_clusters': this.analyzer.get('numClusters'),\n            'pre_num_coherent_sentences': this.analyzer.get('cohSentences'),\n            'pre_num_non_coherent_sentences': this.analyzer.get('cohNotSentences'),\n            'pre_num_concepts': this.analyzer.get('numConcepts')});\n\n        // Change html of modal\n        $('#modal-help').find('.modal-content').html(this.userModel.get('instructionreview'));\n        \n        // Open revision modal\n        $('#modal-help').openModal();\n    },\n\n    saveText: function() {\n        var self = this;\n\n        // Get seconds subject worked for revision\n        var revisionElapsed = (new Date() - this.postPageDurationStart) / 1000;\n\n        // Render loading ring\n        this.$el.find('#editor-button-div').html(\n            Handlebars.templates['loading-ring']());\n\n        // Get text\n        var text = app.getParagraphs(this.$el.find('#editor-textinput'));\n\n        // Save post text to textModel\n        this.textModel.set({'post_text': text,\n                            'post_page_duration': revisionElapsed});\n\n        // Set text to analyzer\n        this.analyzer.set({'text': text});\n\n        // Fetch data\n        this.analyzer.save(null, {\n            success: function(response) {\n                self.sendToServer();\n            },\n            error: function(model, response) {\n                console.log(response.responseText);\n            }\n        });\n    },\n\n    sendToServer: function() {\n        // Save last data \n        this.textModel.set({'post_num_sentences': this.analyzer.get('numSentences'),\n            'post_num_clusters': this.analyzer.get('numClusters'),\n            'post_num_coherent_sentences': this.analyzer.get('cohSentences'),\n            'post_num_non_coherent_sentences': this.analyzer.get('cohNotSentences'),\n            'post_num_concepts': this.analyzer.get('numConcepts')});\n        \n        // Send data to server\n        this.textModel.save(null, {\n            success: function(response) {\n                // Reload page\n                location.reload();\n            },\n            error: function(model, response) {\n                console.log('error');\n            }\n        });\n    }\n\n});\n\nnew app.SimpleRevisionView();\n\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJzaW1wbGVfcmV2aXNpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFwcCB8fCB7fTtcblxuYXBwLlNpbXBsZVJldmlzaW9uVmlldyA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcbiAgICBcbiAgICBlbDogJyN0cmVhdG1lbnQtc2ltcGxlLXJldmlzaW9uJyxcblxuICAgIGV2ZW50czoge1xuICAgICAgICAnY2xpY2sgI2luc3RydWN0aW9uLXJlYWQnOiAncmVuZGVyRWRpdG9yJyxcbiAgICAgICAgJ2NsaWNrICNoZWxwJzogJ3JlbmRlckluc3RydWN0aW9uTW9kYWwnLFxuICAgICAgICAnY2xpY2sgI2VkaXRvci1idXR0b24nOiAnYW5hbHl6ZVRleHQnLFxuICAgICAgICAnY2xpY2sgI3NhdmUtdGV4dCc6ICdzYXZlVGV4dCcsXG4gICAgfSxcblxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBWYXJpYWJsZSBkZWNsYXJhdGlvblxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMucHJlUGFnZUR1cmF0aW9uU3RhcnQgPSBudWxsO1xuICAgICAgICB0aGlzLnBvc3RQYWdlRHVyYXRpb25TdGFydCA9IG51bGw7XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgdXNlciBkYXRhXG4gICAgICAgIHRoaXMudXNlck1vZGVsID0gbmV3IGFwcC5Vc2VyU3BlY2lmaWNNb2RlbCgpO1xuXG4gICAgICAgIC8vIEluaXQgdGV4dGFuYWx5emVyIG1vZGVsXG4gICAgICAgIHRoaXMudGV4dE1vZGVsID0gbmV3IGFwcC5UZXh0TW9kZWxDb21wbGV0ZSgpO1xuXG4gICAgICAgIC8vIEluaXQgdGV4dEFuYWx5emVyIG1vZGVsXG4gICAgICAgIHRoaXMuYW5hbHl6ZXIgPSBuZXcgYXBwLlRleHRBbmFseXplck1vZGVsKCk7XG5cbiAgICAgICAgLy8gRmV0Y2ggdXNlciBkYXRhXG4gICAgICAgIHRoaXMudXNlck1vZGVsLmZldGNoKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKG1vZGVsLCByZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHNlbGYucmVuZGVySW5zdHJ1Y3Rpb24oKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24obW9kZWwsIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLyoqIFJlbmRlciBpbnN0cnVjdGlvbiBmb3IgXG4gICAgICAqIHRoaXMgcGFydCBvZiB0aGUgZXhwZXJpbWVudFxuICAgICAgKi9cbiAgICByZW5kZXJJbnN0cnVjdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIFJlbmRlciBpbnN0cnVjdGlvblxuICAgICAgICB0aGlzLiRlbC5odG1sKFxuICAgICAgICAgICAgSGFuZGxlYmFycy50ZW1wbGF0ZXMuaW5zdHJ1Y3Rpb24oeydpbnN0cnVjdGlvbic6XG4gICAgICAgICAgICAgICAgdGhpcy51c2VyTW9kZWwuZ2V0KCdpbnN0cnVjdGlvbicpfSkpO1xuICAgIH0sXG5cbiAgICAvKiogXG4gICAgICogV2hlbiB1c2VyIGhhcyByZWFkIHRoZSBpbnN0cnVjdGlvbiBoZSBvciBzaGUgaXMgYWJsZVxuICAgICAqIHRvIHdyaXRlIHRoZWlyIHRleHQuXG4gICAgICovXG4gICAgcmVuZGVyRWRpdG9yOiBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gU3RhcnQgdGltZXIgZm9yIGRyYWZ0XG4gICAgICAgIHRoaXMucHJlUGFnZUR1cmF0aW9uU3RhcnQgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAgIC8vIFJlbmRlciBlZGl0b3JcbiAgICAgICAgdGhpcy4kZWwuaHRtbChIYW5kbGViYXJzLnRlbXBsYXRlcy5lZGl0b3IoKSk7XG5cbiAgICAgICAgLy8gRW5hYmxlIGVkaXRvciBmdW5jdGlvbmFsaXR5XG4gICAgICAgIHZhciBlZGl0b3IgPSBuZXcgTWVkaXVtRWRpdG9yKCcjZWRpdG9yLXRleHRpbnB1dCcsIHtcbiAgICAgICAgICAgIHRvb2xiYXI6IGZhbHNlLFxuICAgICAgICAgICAgcGxhY2Vob2xkZXI6IGZhbHNlLFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBBZGQgdGV4dCB0byBlZGl0b3JcbiAgICAgICAgJCgnI2VkaXRvci10ZXh0aW5wdXQnKS5odG1sKCc8cD5TY2hyZWliZSBoaWVyIC4uLjwvcD4nKTtcblxuICAgICAgICAvLyBTZWxlY3QgdGV4dCBzbyB0aGF0IHVzZXIgY2FuIHR5cGUgaW5zdGFudGx5XG4gICAgICAgIHZhciBlZGl0YWJsZUVsZW1lbnQgPSBkb2N1bWVudC5cbiAgICAgICAgICAgIHF1ZXJ5U2VsZWN0b3IoJyNlZGl0b3ItdGV4dGlucHV0JykuZmlyc3RDaGlsZDtcbiAgICAgICAgZWRpdG9yLnNlbGVjdEVsZW1lbnQoZWRpdGFibGVFbGVtZW50KTtcblxuICAgICAgICAvLyBBcHBlbmQgaGVscCBidXR0b24gdG8gd2luZG93XG4gICAgICAgIHRoaXMuJGVsLmFwcGVuZCgnPGkgaWQ9XCJoZWxwXCIgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiPmhlbHA8L2k+Jyk7XG5cbiAgICAgICAgLy8gQXBwZW5kIG1vZGFsIFxuICAgICAgICB0aGlzLiRlbC5hcHBlbmQoSGFuZGxlYmFycy50ZW1wbGF0ZXNbJ21vZGFsLWhlbHAnXSh7J2luc3RydWN0aW9uJzpcbiAgICAgICAgICAgIHRoaXMudXNlck1vZGVsLmdldCgnaW5zdHJ1Y3Rpb24nKSB9KSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJlbmRlciBtb2RhbCBvZiBpbnN0cnVjdGlvblxuICAgICAqL1xuICAgIHJlbmRlckluc3RydWN0aW9uTW9kYWw6IGZ1bmN0aW9uKCkge1xuICAgICAgICAkKCcjbW9kYWwtaGVscCcpLm9wZW5Nb2RhbCgpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBBZnRlciB1c2VyIGhhcyB3cml0dGVuIGhpcyBvciBoZXIgdGV4dCB0aGUgXG4gICAgICogdXNlciBnZXRzIGZlZWRiYWNrIG9uIHRoZSBkcmFmdC4gXG4gICAgICogQmVmb3JlIHVzZXJzIGNhbiBzZWUgdGhlIGZlZWRiYWNrIHdlIG5lZWQgXG4gICAgICogdG8gbWFrZSBzb21lIHNhbml0eSBjaGVja3Mgd2hldGhlciB0aGUgXG4gICAgICogdGV4dCBpcyBsb25nIGVub3VnaC5cbiAgICAgKi9cbiAgICBhbmFseXplVGV4dDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICAvLyBDaGFuZ2UgdGV4dCB3aXRoIG1ham9yIGNvbmNlcHRzXG4gICAgICAgIGFwcC5yZWdFeFRleHQoJyNlZGl0b3ItdGV4dGlucHV0Jyk7XG5cbiAgICAgICAgLy8gR2V0IHRleHRcbiAgICAgICAgdmFyIHRleHQgPSBhcHAuZ2V0UGFyYWdyYXBocyh0aGlzLiRlbC5maW5kKCcjZWRpdG9yLXRleHRpbnB1dCcpKTtcblxuICAgICAgICAvLyBDaGVjayBpZiB0ZXh0IGlzIGxvbmcgZW5vdWdoXG4gICAgICAgIGlmICh0ZXh0Lmxlbmd0aCA8IDEwMDApIHtcbiAgICAgICAgICAgIC8vIERpc3BsYXkgdG9hc3RcbiAgICAgICAgICAgIE1hdGVyaWFsaXplLnRvYXN0KCdJaHIgVGV4dCBpc3QgbGVpZGVyIHp1IGt1cnouJywgNDAwMCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBTdG9wIHRpbWVyIGZvciBkcmFmdFxuICAgICAgICAgICAgdmFyIGRyYWZ0RWxhcHNlZCA9IChuZXcgRGF0ZSgpIC0gdGhpcy5wcmVQYWdlRHVyYXRpb25TdGFydCkgLyAxMDAwO1xuXG4gICAgICAgICAgICAvLyBTdGFydCB0aW1lciBmb3IgdGV4dCByZXZpc2lvblxuICAgICAgICAgICAgdGhpcy5wb3N0UGFnZUR1cmF0aW9uU3RhcnQgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAgICAgICAvLyBTZXQgZHJhZnQgdGltZSBhbmQgZHJhZnRUZXh0IHRvIHRleHRNb2RlbFxuICAgICAgICAgICAgdGhpcy50ZXh0TW9kZWwuc2V0KHsncHJlX3BhZ2VfZHVyYXRpb24nOiBkcmFmdEVsYXBzZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdwcmVfdGV4dCc6IHRleHR9KTtcblxuICAgICAgICAgICAgLy8gUmVuZGVyIGxvYWRpbmcgcmluZ1xuICAgICAgICAgICAgdGhpcy4kZWwuZmluZCgnI2VkaXRvci1idXR0b24tZGl2JykuaHRtbChcbiAgICAgICAgICAgICAgICBIYW5kbGViYXJzLnRlbXBsYXRlc1snbG9hZGluZy1yaW5nJ10oKSk7XG5cbiAgICAgICAgICAgIC8vIEdldCB0ZXh0IGRhdGFcbiAgICAgICAgICAgIHRoaXMuYW5hbHl6ZXIuc2V0KHsndGV4dCc6IHRleHR9KTtcbiAgICAgICAgICAgIHRoaXMuYW5hbHl6ZXIuc2F2ZShudWxsLCB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZW5kZXJSZXZpc2lvbigpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKG1vZGVsLCByZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEFmdGVyIHVzZXIgaGFzIHdyaXR0ZW4gdGhlIGRyYWZ0IHNoZSBnZXRzIHRoZSBcbiAgICAgKiBvcHBvcnR1bml0eSB0byByZXZpc2UgaGVyIHRleHRcbiAgICAgKi9cbiAgICByZW5kZXJSZXZpc2lvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIFJlbmRlciBzdWJtaXQgYnV0dG9uXG4gICAgICAgIHRoaXMuJGVsLmZpbmQoJyNlZGl0b3ItYnV0dG9uLWRpdicpLmh0bWwoXG4gICAgICAgICAgICAgICAgJzxhIGNsYXNzPVwid2F2ZXMtZWZmZWN0IHdhdmVzLWxpZ2h0IGJ0blwiIGlkPVwic2F2ZS10ZXh0XCI+VGV4dCBhYnNjaGlja2VuPC9hPicpO1xuXG4gICAgICAgIC8vIFNhdmUgZGF0YSBmb3IgZHJhZnRcbiAgICAgICAgdGhpcy50ZXh0TW9kZWwuc2V0KHsncHJlX3RleHQnOiB0aGlzLmFuYWx5emVyLmdldCgndGV4dCcpLFxuICAgICAgICAgICAgJ3ByZV9udW1fc2VudGVuY2VzJzogdGhpcy5hbmFseXplci5nZXQoJ251bVNlbnRlbmNlcycpLFxuICAgICAgICAgICAgJ3ByZV9udW1fY2x1c3RlcnMnOiB0aGlzLmFuYWx5emVyLmdldCgnbnVtQ2x1c3RlcnMnKSxcbiAgICAgICAgICAgICdwcmVfbnVtX2NvaGVyZW50X3NlbnRlbmNlcyc6IHRoaXMuYW5hbHl6ZXIuZ2V0KCdjb2hTZW50ZW5jZXMnKSxcbiAgICAgICAgICAgICdwcmVfbnVtX25vbl9jb2hlcmVudF9zZW50ZW5jZXMnOiB0aGlzLmFuYWx5emVyLmdldCgnY29oTm90U2VudGVuY2VzJyksXG4gICAgICAgICAgICAncHJlX251bV9jb25jZXB0cyc6IHRoaXMuYW5hbHl6ZXIuZ2V0KCdudW1Db25jZXB0cycpfSk7XG5cbiAgICAgICAgLy8gQ2hhbmdlIGh0bWwgb2YgbW9kYWxcbiAgICAgICAgJCgnI21vZGFsLWhlbHAnKS5maW5kKCcubW9kYWwtY29udGVudCcpLmh0bWwodGhpcy51c2VyTW9kZWwuZ2V0KCdpbnN0cnVjdGlvbnJldmlldycpKTtcbiAgICAgICAgXG4gICAgICAgIC8vIE9wZW4gcmV2aXNpb24gbW9kYWxcbiAgICAgICAgJCgnI21vZGFsLWhlbHAnKS5vcGVuTW9kYWwoKTtcbiAgICB9LFxuXG4gICAgc2F2ZVRleHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgLy8gR2V0IHNlY29uZHMgc3ViamVjdCB3b3JrZWQgZm9yIHJldmlzaW9uXG4gICAgICAgIHZhciByZXZpc2lvbkVsYXBzZWQgPSAobmV3IERhdGUoKSAtIHRoaXMucG9zdFBhZ2VEdXJhdGlvblN0YXJ0KSAvIDEwMDA7XG5cbiAgICAgICAgLy8gUmVuZGVyIGxvYWRpbmcgcmluZ1xuICAgICAgICB0aGlzLiRlbC5maW5kKCcjZWRpdG9yLWJ1dHRvbi1kaXYnKS5odG1sKFxuICAgICAgICAgICAgSGFuZGxlYmFycy50ZW1wbGF0ZXNbJ2xvYWRpbmctcmluZyddKCkpO1xuXG4gICAgICAgIC8vIEdldCB0ZXh0XG4gICAgICAgIHZhciB0ZXh0ID0gYXBwLmdldFBhcmFncmFwaHModGhpcy4kZWwuZmluZCgnI2VkaXRvci10ZXh0aW5wdXQnKSk7XG5cbiAgICAgICAgLy8gU2F2ZSBwb3N0IHRleHQgdG8gdGV4dE1vZGVsXG4gICAgICAgIHRoaXMudGV4dE1vZGVsLnNldCh7J3Bvc3RfdGV4dCc6IHRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3Bvc3RfcGFnZV9kdXJhdGlvbic6IHJldmlzaW9uRWxhcHNlZH0pO1xuXG4gICAgICAgIC8vIFNldCB0ZXh0IHRvIGFuYWx5emVyXG4gICAgICAgIHRoaXMuYW5hbHl6ZXIuc2V0KHsndGV4dCc6IHRleHR9KTtcblxuICAgICAgICAvLyBGZXRjaCBkYXRhXG4gICAgICAgIHRoaXMuYW5hbHl6ZXIuc2F2ZShudWxsLCB7XG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHNlbGYuc2VuZFRvU2VydmVyKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKG1vZGVsLCByZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBzZW5kVG9TZXJ2ZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBTYXZlIGxhc3QgZGF0YSBcbiAgICAgICAgdGhpcy50ZXh0TW9kZWwuc2V0KHsncG9zdF9udW1fc2VudGVuY2VzJzogdGhpcy5hbmFseXplci5nZXQoJ251bVNlbnRlbmNlcycpLFxuICAgICAgICAgICAgJ3Bvc3RfbnVtX2NsdXN0ZXJzJzogdGhpcy5hbmFseXplci5nZXQoJ251bUNsdXN0ZXJzJyksXG4gICAgICAgICAgICAncG9zdF9udW1fY29oZXJlbnRfc2VudGVuY2VzJzogdGhpcy5hbmFseXplci5nZXQoJ2NvaFNlbnRlbmNlcycpLFxuICAgICAgICAgICAgJ3Bvc3RfbnVtX25vbl9jb2hlcmVudF9zZW50ZW5jZXMnOiB0aGlzLmFuYWx5emVyLmdldCgnY29oTm90U2VudGVuY2VzJyksXG4gICAgICAgICAgICAncG9zdF9udW1fY29uY2VwdHMnOiB0aGlzLmFuYWx5emVyLmdldCgnbnVtQ29uY2VwdHMnKX0pO1xuICAgICAgICBcbiAgICAgICAgLy8gU2VuZCBkYXRhIHRvIHNlcnZlclxuICAgICAgICB0aGlzLnRleHRNb2RlbC5zYXZlKG51bGwsIHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgLy8gUmVsb2FkIHBhZ2VcbiAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24obW9kZWwsIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxufSk7XG5cbm5ldyBhcHAuU2ltcGxlUmV2aXNpb25WaWV3KCk7XG4iXSwiZmlsZSI6InNpbXBsZV9yZXZpc2lvbi5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9\n"],"sourceRoot":"/source/"}